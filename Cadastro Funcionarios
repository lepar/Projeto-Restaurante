#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct funcionario preenche();



struct funcionario {
	int id;
    char nome[25], funcao[20], codigo[6];
};

struct funcionario preenche(int contador)
{
    struct funcionario cliente;
	
    contador=contador+1;
    cliente.id=contador;
    setbuf (stdin, NULL);
    printf("\nNome do funcionario:");
	scanf("%[^\n]s", cliente.nome);
	setbuf (stdin, NULL);
	printf("\nFuncao do funcionario:");
	scanf("%[^\n]s", cliente.funcao);
	setbuf (stdin, NULL);
	printf("\nCodigo do funcionario:");
	scanf("%[^\n]s", cliente.codigo);
	setbuf (stdin, NULL);
    return cliente;
}

int funcionario(int argc, char **argv)
{	
 int num=0, contador, resposta, aux=0, procurar=0, opcao=0, editar=0;
 struct funcionario *vetor;
 struct funcionario *auxvetor;
 
 do{
 system("cls");
 printf("Escolha uma opcao:");
 printf("\n1 - Cadastrar funcionarios.");
 printf("\n2 - Editar um funcionario cadastrado.");
 printf("\n3 - Excluir um funcionario cadastrado.");
 printf("\n\n\nEntre com outro valor para sair. \n");
 scanf("%d", &opcao);
 switch (opcao)
 {
    case 1:
    {   
      
         vetor = malloc(num * sizeof(struct funcionario));
         while(1)
         {
           for(contador = aux; contador<num; contador++)
           {
              vetor[contador] = preenche(contador);
           }
           printf("\nDeseja cadastrar mais funcionarios ? \n Digite 1 para Sim ou 2 para Nao! \n");
           scanf("%d", &resposta);
           if(resposta==1)
           {
              aux = num;
              num = num + 1;
              auxvetor = malloc(aux * sizeof(struct funcionario));
              for(contador = 0; contador < aux; contador++)
              {
                 auxvetor[contador] = vetor[contador];
              }
              vetor = malloc(num * sizeof(struct funcionario));
              for(contador = 0; contador < aux; contador++)
              {
                 vetor[contador] = auxvetor[contador];
              }
            }
            else 
            //sair quando a resposta for nao
            { break; }
         }
    }
    break;
    case 2:
    {
         
         printf("\nEntre com a ID do funcionario:");
         scanf("%d", &editar);
         for(contador=0;contador<num;contador++)
         {
            if(vetor[contador].id == editar)
            {
               vetor[contador] = preenche(contador);
            }
         }
    }
    break;     
    case 3:
    {
         system("cls");
         printf("\nEntre com a ID do funcionario:");
         scanf("%d", &editar);
         for(contador=0;contador<num;contador++)
         {
            if(vetor[contador].id == editar)
            {
               vetor[contador].id = 0;
            }
         }
    }
    break;
    case 4:
         return 0;
    break;
  }
 
  for(contador = 0; contador < num; contador++)
    {
      printf("\n\n\n ID: %d - NOME: %s - FUNCAO: %s - CODIGO: %s\n", vetor[contador].id, vetor[contador].nome, vetor[contador].funcao, vetor[contador].codigo);
    }
 
 printf("\n\n\nDeseja retornar ao menu de funcionarios ? \n Digite 1 para Sim ou 2 para Nao! \n");
 scanf("%d", &opcao);
 }while(opcao==1);
    free(vetor);
    free(auxvetor);
}
